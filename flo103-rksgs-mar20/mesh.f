      subroutine  mesh
c
c     ******************************************************************
c     *                                                                *
c     *   generates the mesh                                           *
c     *                                                                *
c     ******************************************************************
c
      use dims
c
c     ******************************************************************
c
      use geo_var
      use mesh_var
c
c     ******************************************************************
c
      use flo_param
      use geo_param
c
c     ******************************************************************
c
      implicit none
c
c     ******************************************************************
c
c     local variables
c
c     ******************************************************************
c
      integer  :: i,j
c
c     ******************************************************************
c
      real     :: x0,y0,s1,yp,r,angl
c
c     ******************************************************************
c
      x0        = xsing/scal
      y0        = ysing/scal

      do j=1,jl

      s1        = 1.  -(float(j  -1)/float(jl  -1))**2

      do i=1,il

      yp        = a1(i)*b0(j)  +s1*s0(i)
      x(i,j,1)  = x0  +.5*(a0(i)*a0(i)  -yp*yp)
      x(i,j,2)  = y0  +a0(i)*yp

      end do
      end do

      return

      end
